= Content and content types
include::variables.adoc[]
:project-name: content
:project-name-full: {project-name-prefix}{project-name}

In this {document}, we'll create our first XP application project and generate a GraphQL API for it. In doing this, we'll learn about _content types_ and how to do basic work with  Content Studio.

This {document} builds on the steps we took in the xref:basics[previous {document}], so if you haven't already done it, make sure you go through it and get your sandbox set up and Content Studio installed.

When you're sure you're up to speed with the previous {document}, let's jump right in and create our first XP project.

== Projects and starters

Creating a project from scratch can be a daunting task for any system you're not familiar with. To make things easier for you, Enonic provides a range of different project templates (known as _starters_). We'll make use of these throughout this tutorial.

NOTE: The complete list of starters can be found on https://market.enonic.com/starters[the Enonic Market].

For our first project, we'll use the "Headless CMS" starter. This starter is tailored to start creating your own headless content API, but is fairly minimal. We'll use this to familiarize ourselves with how an XP app is structured and how to upload an app to XP.

Here's how to use the CLI to create your first app.

. Launch a new terminal
. When creating a project via the CLI, it creates a folder in your current working directory, so navigate to wherever you want your project to reside. Then, run this command:

    enonic project create

. Choose `Headless CMS starter` from the list of available starters.
. When prompted enter the name `{project-name-full}` and  press kbd:[enter] to accept.
+
NOTE: Project names matter. XP does not support running two apps with the same name within a single instance.
+
. Use the default values for destination folder and version. If the destination folder already exists, you'll have to either choose another name for the folder or remove or rename the folder that already exists.
. When prompted to select a sandbox, choose the  `tutorial` sandbox we created previously.
. Finally, press kbd:[enter] to skip opening the starter documentation. If you answer yes, the documentation for this starter will open in your browser. This is useful if you're using a starter you're not familiar with (and aren't following a guide).

If you used the default values as specified in the steps, a directory named `{project-name}/` should have been created during the process. If you used a different project name or project directory name, your directory will have a different name.

The project directory contains a fairly minimal XP application. The most relevant parts of the directory are:

.Essential XP project structure
[source,files]
----
build.gradle <--1-->
gradle.properties <--2-->
src/
  main/
    resources/ <!--3-->
----

<1> The main build file for defining dependencies and more build-related details.
<2> Contains the standard project settings, as defined by the CLI.
<3> The main project folder. JavaScript code and assets are placed here.

== Building and deploying

Now that we've set up a project, let's see how we build (or _compile_) the project and then how we deploy it to our XP instance. Again, the CLI is key to making this process as smooth as possible.

Here are the steps we need to take:

. Change to the project directory:
+
[subs="attributes"]
----
cd {project-name}
----
+
. If your sandbox isn't already running, start it by using this command:
+
  enonic sandbox start
+
This will start the sandbox belonging to the current project directory.

. Start the build with Enonic CLI:

    enonic project build

While building your project, the CLI will print what it's doing to your terminal. It will look something like this:

.Sample output from build process
----
Building in sandbox 'tutorial'...
Starting a Gradle Daemon (subsequent builds will be faster)

BUILD SUCCESSFUL in 5s
3 actionable tasks: 3 executed
----

After the build has finished, you'll have a new file in your project directory, located under the `build/libs` subdirectory. Assuming you have used the default name, it'll be located at `build/libs/{project-name}.jar` when at the project root. This file is the executable file that contains your application.

To deploy the app to the sandbox, use the CLI again. From the project root folder, run:

    enonic project deploy

This copies the application file to your sandbox's `home/deploy/` folder. XP picks up on this automatically and starts the app for you.

NOTE: The `enonic project deploy` command will build your project if you have made changes since the last build or haven't built yet. It will also ask whether you want to start the appropriate sandbox if it isn't already running.

To confirm that your application was started correctly, you can look at the logs in the sandbox's terminal window. They should say something like this:

.Application output
[subs="attributes"]
----
[...] - Local application [{project-name-full}] installed successfully
[...] - Application [{project-name-full}] started successfully
----

You can also verify that the application was installed correctly by using the admin console ({xp-url}): Open the "Applications" app from the main launcher panel and look for your application in the list.


.The applications list with the headless starter installed
image::applications-headless.png[The applications list with a few applications installed. Also shows application details, such as content install time, version, and required XP system version for the selected application.]

You've now successfully built and deployed your first Enonic XP application. Well done! Now let's look at creating content.

=== What if the application doesn't show up?

If the application doesn't show up under the Applications tab in XP after you've run `enonic project deploy`, check the logs (for the build first, and then for XP) for errors. The build might have failed or something may have gone wrong when deploying.

If the build works, but nothing shows up in the Applications tab, make sure you're running the right sandbox. The CLI deploys to the sandbox specified in the project's `.enonic` file (in the project directory root). This has to match the name of the sandbox that's running.

If you've checked that you're running the right sandbox and that the build succeeds, but you're still not seeing the application, you can do a manual deploy. The project build result is available in the `build/libs` directory of the project. You can copy this `.jar` file to the sandbox's `home/deploy` directory. This will make XP pick it up. If you've used the suggested names in the steps above (and the default directories for XP configuration), this command will move the file for you on Unix systems when run from the project root:

[subs="attributes"]
  mv build/libs/{project-name}-1.0.0-SNAPSHOT.jar ~/.enonic/sandboxes/tutorial/home/deploy/

NOTE: If you have to deploy manually when going through this tutorial, please get in touch on https://discuss.enonic.com[discuss.enonic.com] so we can improve the documentation and the process.

== My first content type

We've created our first app, but an app isn't terribly exciting if it doesn't have any content to deliver. While content _creation_ takes place inside Content Studio, Content Studio first needs to know something about what kinds of content the end user can create. Enter: _content types_.

=== What are content types?

Content types are schemas that tell XP what properties a piece of content of a particular type can have. That might sound confusing, but imagine for a second that we're working with forms. Content types describe what fields go in a specific form. Then a piece of content is a form that has been filled out. We'll look at an example to make this even clearer.

NOTE: If you're used to working with databases, you can think of content types as table schemas and contents as the rows of a table. The properties are the columns specified by the schema. Similarly, a content type is much like a _(data) type_ or a _class_ in many programming languages: something that describes the shape of your data. A piece of content is a manifestation/instance of that data type. The properties of the content type specify what that data type contains.


Imagine we want our app to list colors. We want each color to have a name and a hexadecimal application, e.g. `red, #ff0000` or `blue, #0000ff`.
Here's what the content type for color could look like. The most relevant parts of the file are numbered and further explained below.

.A simple content type describing the 'color' content type
[source,xml]
----
include::content_content_type.xml[]
----

<1> This is the name of the content type and is what will be displayed in Content Studio when you create a piece of content of this type.
<2> This is where we specify what properties this content type contains. The contents of this tag control what we see and are able to edit in Content Studio.
<3> This is the first property of the color. The `type` attribute specifies what kind of input field the user will see in Content Studio, and the `label` specifies how the input will be labeled.

NOTE: Content types also have a large number of other, optional fields that we won't get into here. If you'd like to learn more about this, consult https://developer.enonic.com/docs/xp/stable/cms/content-types[the reference documentation].

To create an instance of this content type, we could use Content Studio (we'll see exactly how to do this shortly!). Upon exposing it via an API, we would most likely see the piece of content exposed as JSON, so that's what we'll use to illustrate a piece of content.

If we created the color `red, #ff0000` mentioned above, that specific instance of the content type (that piece of content) would be represented in JSON as this:

.A piece of content of type 'color'
[source,json]
----
{
  "name": "red",
  "hex": "#ff0000"
}
----

So, to recap: _content types_ describe the shape of some data that's been grouped together. A piece of _content_ is the manifestation of that content type, populated with actual data. If it's still a bit fuzzy, don't worry! It'll become clearer once we start working with it.

=== Creating a content type

Now that we know what a content type is, let's look at how we create them and make XP recognize them. We'll use the "Color" content type from before to keep things simple.

XP is quite particular about project folder structure, so we need to put content types right where it expects to find them. The location is under `src/main/resources/site/content-types`.

Within the `content-types` directory, we need to place another directory with the name of the content type (in our case: "color"), and within that directory, we place our content type, `color.xml`. As such, the full path to our content type from the project root is `src/main/resources/site/content-types/color/color.xml`.

Now, unless you've created it manually, then that directory doesn't exist in our "{project-name}" project yet, so go ahead and create the required directories and files.

In the `color.xml` file, place the following contents:
[source,xml]
----
include::content_content_type.xml[]
----

Now run:

  enonic project deploy

If everything goes well, you should see your sandbox logs update now. And that's the basics of creating new content types. Next, let's turn our eyes to Content Studio and create some actual content!

== Content Creation 101

After the preceding few steps, everything is ready for us to create some actual content! So with your sandbox up and running, and navigate to {cs-url}[Content Studio]. You should be met with an empty studio that tells you you are "wasting this space":

.An empty content studio
image::content-studio-empty.png[What Content Studio looks like when it's completely empty.]

=== Creating a site

Before we can create our content, we need a "site" to hold it. Sites in Content Studio are ... [explain sites here!]

To get going, press the "New..." button in the command bar or use the keyboard shortcut kbd:[Alt+n]. This will bring up a "Create Content" dialog looking something like this:

.The Content Studio create content dialog
image::content-studio-create-content.png[The Content Studio create content dialog.]

Select "Site" either by clicking on it, or by navigating to it with your keyboard. You can start typing as soon as the dialog opens to filter the options too!

When you select it, your browser will take you to a new tab (or window depending on your browser settings). This page is an edit page for the content you just created. Just like with our "color" content type.

.Creating a new site in Content Studio.
image::content-studio-new-site.png[Creating a new site in content studio. There is a form with site options on the left.]

Add the required data ...

Select "{project-name}" from the applications list ...

=== Add a dash of color

Create the color ...

Try and create some more? ...

== Querying the API

Now that we've created some content, how about we try and query the API to see if we can fetch it?

Introduces the GraphQL API (and mentions that it's automatically generated by Guillotine) and how to use it.
