= Rich text: HtmlArea
include::variables.adoc[]
:macro-name: mySuccess

When you want to ... rich text is the way to go, and if you want to work with rich text in Content Studio, HtmlArea is your friend.

We briefly mentioned the HtmlArea input type in the previous {document}, but didn't say much about it -- not because there's nothing to be said about it. The situation is actually quite the opposite. This rich text input type offers some very powerful editing capabilities and a lot of configuration options. As such, this whole {document} is dedicated to that one input type, how it works, and how to use it in a headless fashion.

== The HtmlArea: an overview

.The default HtmlArea input type
image::input-type-html-area.png[HtmlArea: A rich text input field with visible formatting options., width=600]

The HtmlArea input type gives you a multi-line input field with rich formatting options, much like what you're used to from your favorite word processor. It supports text formatting and justification, lists, links, and even lets you insert images.

You can configure the HtmlArea to be exactly what you want by dictating what formatting tools to include or exclude (the `include` and `exclude` attributes, respectively), by what heading levels are allowed (`allowedHeadings`), and by giving it a default value (`default`).

Additionally, the HtmlArea supports the use of _macros_. Macros let you automatically insert arbitrary markup into your rendered content and is perfect for cases when you want to add banners, add footers, contact info, or the like. // <- TODO: might need to rethink this ðŸ¤”

== Configuration of text tools

We can use the HtmlArea's `config` section to specify which rich text controls should be available when editing. Using a combination of the `include` and `exclude` tags, we can customize the input's appearance.

If you want to include all controls, use `<include>*</include>` as shown below:

.The HtmlArea configured to include everything
[source,xml]
----
<input type="HtmlArea" name="everything">
  <label>HtmlArea with 'include *'</label>
  <config>
    <include>*</include>
  </config>
</input>
----

.An HtmlArea input with `<include>*</include>`
image::input-type-html-area-all-controls.png["An HtmlArea configured to include all editing tools.", width=600]


If you want to exclude all controls, use `<exclude>*</exclude>`:


.The HtmlArea configured to include nothing
[source,xml]
----
<input type="HtmlArea" name="nothing">
  <label>HtmlArea with exclude: *</label>
  <config>
    <exclude>*</exclude>
  </config>
</input>
----

.An HtmlArea exput with `<exclude>*</exclude>`
image::input-type-html-area-no-controls.png[An HtmlArea configured to exclude all editing tools., width=600]

Finally, if you want to exclude most tools, but not all, you can exclude all and then add back in the ones you want:

.The HtmlArea configured to include a selection of controls
[source,xml]
----
<input type="HtmlArea" name="something">
  <label>HtmlArea with some controls</label>
  <config>
    <exclude>*</exclude>
    <include>Format | Bold Italic Underline | JustifyBlock
    JustifyLeft JustifyCenter JustifyRight | HorizontalRule Blockquote</include>
  </config>
</input>
----

.An HtmlArea with a selection of tools and `<exclude>*</exclude>`
image::input-type-html-area-some-controls.png[An HtmlArea configured to include a selection of editing tools., width=600]

== Images

If you have configured your HtmlArea to include the image tool, you can click the image button to insert an image. Once you select an image, you'll get a prompt that allows you to customize the image. You can add a caption, alt text, change the image's justification in the block, and apply predefined styles. There's also a pencil icon in the upper right corner that allows you to edit the image. This icon takes you to Content Studio's image editing facilities where you can edit the image by cropping, rotating, or flipping it. You can also add an image focal point, so that if the image gets cropped for some reason, you're in control of what part of the image remains visible.

To read more about Content Studio's image handling capabilities, check out this https://enonic.com/blog/enonic-simplifies-image-problems[blog post on how Enonic simplifies your everyday image problems].

== Macros

Macros allow you to easily add content and formatting to your rich text area. When the page is rendered, the macro call is resolved and replaced. When the macro is resolved, it will either add text to your page or styles or scripts. See the https://developer.enonic.com/docs/xp/stable/cms/macros[macro reference docs] for a more in-depth explanation of how this works. In this guide, we'll see some examples of macros and then look at how we can create our own.

=== Using macros

Adding macros to HtmlAreas looks quite a lot like the XML configuration we've been doing up until now, except that we use square brackets instead of angle brackets (`[]` instead of `<>`). You specify the name and any required attributes. Some macros are self-closing and accept no contents, while others accept content and must be closed later. To close a self-closing macro, add a `/` before the first closing bracket (`]`).

.An example of a self closing macro
[src]
  [selfClosingMacro param="value" /]

.An example of a macro with content
[src]
  [contentMacro param="value"]This content goes inside the macro![/contentMacro]

A good example of what macros can be useful for is the https://market.enonic.com/vendors/enonic/com.enonic.app.panelmacros[`Panel Macros` XP app] which gives you colored panels that you can add important text to.

.The Panel Macros package image
image::macros-panel-macros.jpg["The Panel Macros package in action, showing differently colored panels." , width=600]

To use it, you'd pick your desired panel type (as listed in https://github.com/enonic/app-panel-macros#readme[the library documentation]), such as `success`. If you also want a header, you can specify that using the `header` attribute. If we wanted a `success` panel with a header, we'd add something like this to our HtmlArea:

.Using a panel macro
[src]
  [success header="Congrats!"]You did it! Give yourself a well-deserved pat on the back ðŸ¥³[/success]

=== Creating our own macro

If you want to create your own macro, that's possible too, and it doesn't have to take too much work. Let's look at how we can recreate the `success` macro from above. Of course, you'd probably just install the Panel Macros app if you needed it in an app, but this is a great chance to learn a little bit about macros. We'll call the macro `{macro-name}`.

First off, let's create a _macro descriptor_. A macro descriptor is an XML file that lets you give a macro a friendly display name and a description, as well as a way for you to document the macro parameters. It's not strictly required, but very recommended. A macro descriptor goes in `src/main/resources/site/macros/<macro-name>/<macro-name>.xml`. In our case, that's `src/main/resources/site/macros/{macro-name}/{macro-name}.xml`. Here's the descriptor we'll be using:

.The XML descriptor for the {macro-name} macro
[src,xml]
----
<macro>
  <display-name>My success</display-name>
  <description>Display a success message in an appropriate color</description>

  <form>
    <input name="header" type="TextLine"> <!--1-->
      <label>Header</label>
      <occurrences minimum="0" maximum="1"/>
    </input>
    <input name="body" type="TextArea"> <!--2-->
      <label>Text</label>
      <occurrences minimum="0" maximum="1"/>
    </input>
  </form>
</macro>
----

<1> This is the `header` parameter. This has to be specified as a macro attribute.
<2> This is the `body` parameter. It's automatically mapped to whatever is inside the macro tag and is not assigned explicitly.

Notice how both inputs are optional and define what sort of input they accept (single and multi-line text respectively).

Now for

== Rich text in a headless context

HtmlArea spits out HTML. What does this mean for headless contexts? Do you want that? Could it be updated to support spitting out other formats in the future?

=== GraphQL queries

Create multiple queries, demonstrating what happens to the macros and to images (including srcset). You should also have a query that provides params to the images to get them at a certain width.
